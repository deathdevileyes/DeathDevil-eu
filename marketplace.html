<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Marktplatz ‚Äì DeathDevil.Eu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.cdnfonts.com/css/minecraft-4" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: 'Minecraft', monospace;
  background: #0b0d10;
  color: #eaeaea;
}

header {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 18px 30px;
  background: rgba(0,0,0,0.85);
  border-bottom: 1px solid #6e0a16;
}

header a {
  color: #2ecc71;
  text-decoration: none;
}

h1 {
  text-align: center;
  margin: 35px 0 10px;
  color: #2ecc71;
}

.hint {
  text-align: center;
  color: #a0a0a0;
  margin-bottom: 30px;
  font-size: 14px;
}

/* CONTROLS */
.controls {
  display: flex;
  justify-content: center;
  margin-bottom: 35px;
}

.controls input {
  background: rgba(20,20,25,0.9);
  border: 1px solid #6e0a16;
  color: #eaeaea;
  font-family: 'Minecraft', monospace;
  padding: 10px 14px;
}

/* GRID */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
  gap: 24px;
  padding: 0 40px 80px;
  max-width: 1300px;
  margin: auto;
}

.item {
  background: rgba(20,20,25,0.85);
  border: 1px solid #6e0a16;
  padding: 18px;
  text-align: center;
  box-shadow: 0 0 15px rgba(177,18,38,0.6);
}

.item span {
  display: block;
  margin: 10px 0;
}

/* TOP DEAL */
.item.deal {
  border-color: #2ecc71;
  box-shadow: 0 0 25px rgba(46,204,113,0.9);
}
</style>
</head>

<body>

<header>
  <a href="index.html">‚¨Ö Startseite</a>
</header>

<h1>üõí Server-Marktplatz</h1>

<div class="hint">
‚ÑπÔ∏è Preise √§ndern sich <b>automatisch t√§glich</b>.<br>
üî• Top-Deals werden hervorgehoben.
</div>

<div class="controls">
  <input id="searchInput" placeholder="üîç Item suchen‚Ä¶">
</div>

<div class="grid" id="market"></div>

<script>

let allItems = [];

fetch("./prices.json")
  .then(res => {
    if (!res.ok) throw new Error("HTTP " + res.status);
    return res.json();
  })
  .then(data => {
    allItems = data.items.map(i => ({
      ...i,
      category: i.category || "Sonstiges"
    }));
    render();
  })
  .catch(err => {
    console.error(err);
    document.getElementById("market").innerHTML =
      "<p style='grid-column:1/-1;text-align:center;color:red'>‚ùå Preise konnten nicht geladen werden</p>";
  });

const market = document.getElementById("market");
const searchInput = document.getElementById("searchInput");

searchInput.oninput = render;

function render() {

  let items = [...allItems];

  const q = searchInput.value.toLowerCase();

  if (q) {
    items = items.filter(i =>
      i.name.toLowerCase().includes(q)
    );
  }

  market.innerHTML = "";

  if (!items.length) {
    market.innerHTML =
      "<p style='grid-column:1/-1;text-align:center;color:#a0a0a0'>‚ùå Keine Items gefunden</p>";
    return;
  }

  const cheapest =
    [...items].sort((a,b)=>a.price-b.price)[0];

  items.forEach(i => {

    const div = document.createElement("div");

    div.className =
      "item" + (i === cheapest ? " deal" : "");

    div.innerHTML = `
      ${i.icon}
      <span>${i.amount}√ó ${i.name}</span>
      <b>${i.price.toFixed(2)} ‚Ç¨</b>
    `;

    market.appendChild(div);

  });

}

</script>

</body>
</html>
