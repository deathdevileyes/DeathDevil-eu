<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Bewertungen â€“ DeathDevil.Eu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family:Inter,sans-serif;
  background:#0b0d10;
  color:white;
  padding:40px;
}
.stat{
  margin-bottom:30px;
  font-size:18px;
}
.bar{
  background:#333;
  height:20px;
  margin:5px 0;
  border-radius:4px;
}
.fill{
  background:gold;
  height:100%;
  border-radius:4px;
}
.box{
  background:#141419;
  padding:15px;
  margin-bottom:15px;
  border-radius:10px;
}
</style>
</head>
<body>

<h1>ğŸ“Š Server Bewertungen</h1>

<div id="stats" class="stat"></div>
<div id="distribution"></div>
<hr>
<div id="list"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCnOCp8Ue6c728ndQLz4WJ--o4I2wI1QKU",
  authDomain: "bewertungen-deathdevileu.firebaseapp.com",
  projectId: "bewertungen-deathdevileu"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const snapshot = await getDocs(collection(db, "bewertungen"));

let total = 0;
let count = 0;
let starsCount = {1:0,2:0,3:0,4:0,5:0};

snapshot.forEach(doc=>{
  const data = doc.data();
  total += data.stars;
  count++;
  starsCount[data.stars]++;

  document.getElementById("list").innerHTML += `
    <div class="box">
      <strong>${data.name}</strong> â€“ â­ ${data.stars}/5<br>
      ${data.feedback || ""}<br>
      <em>${data.wunsch || ""}</em>
    </div>
  `;
});

const avg = count ? (total/count).toFixed(2) : 0;

document.getElementById("stats").innerHTML =
  `â­ Durchschnitt: ${avg}/5 | ğŸ“ˆ Bewertungen: ${count}`;

for(let i=5;i>=1;i--){
  const percent = count ? (starsCount[i]/count)*100 : 0;
  document.getElementById("distribution").innerHTML += `
    ${i} â­
    <div class="bar">
      <div class="fill" style="width:${percent}%"></div>
    </div>
  `;
}
</script>

</body>
</html>
